---
layout: "post"
title: "PCIe 3.0とPCIe 4.0のGPUの性能差調査"
category: "自作PC"
tags: ["ベンチマーク", "GPU"]
---
# PCIe 3.0とPCIe 4.0での性能差が気になる

結構前から気になっていたことがありまして、それがグラボの性能的にPCIe 3.0 x16も必要がないという噂です。

理由は詳しく知りませんが、PCIe 3.0 x16もx8も性能差が10%にも満たないという話で、x16を1つのGPUに割くぐらいなら、SLIやNVMe SSDなどに使用したほうが良いということです。

ふと、その噂を思い出したので、実際に試してみました、

下に詳しく書いてありますが、自分のPCはRyzen7 5800X及び、Radeon 6800XTを使用してます。

マザーこそB550ですが、CPU直結レーンに関してはPCIe 4.0を使えます。

なので、今回はPCIe 3.0,4.0の差、x16,x8の差、SAMの差の8通りを調べました。

## 検証環境
検証環境は自分のメイン機です。
|パーツ|品名|備考|
|---|---|---|
|CPU|AMD Ryzen 7 5800X|PBO2有効|
|GPU|Radeon 6800XT|GDDR6 + Infinity Cache<br>Driver: 22.5.2|
|Mem|DDR4 16GB x2|2400MHz|
|SSD|SM750 512GB||
|M/B|ASRock B550 SteelLegend|P2.20|
|OS|Windows 10 Pro|21H2, Build 19044.1741|

Radeon 6800XTはInfinity Cacheがあるので、キャッシュに乗るような処理では差が出なかったりしそうですが、どうなんでしょうね。

![PC Spec](/assets/img/2022/06/08/explorer_gupdRFKlQZ.png)

## 検証方法
3DMarkとFF14とのベンチマークを回します。

3DMarkでは

- TimeSpy
- FireStrike Ultra
- PCIe機能テスト

の3つをベンチマークで回します。

FF14は2560x1080 最高画質設定の仮想フルスクリーンで回しました。

`Smart Access Memory`の有無で性能が変わるかもしれないので、それも切り替えて検証します。

## 結果

### 3DMark

|PCIe Gen|レーン数|SAM|TimeSpy|FireStrike|PCIe機能テスト|
|---:|---:|:---:|---:|---:|---:|
|4.0|x16|有効|[17,100](https://www.3dmark.com/3dm/76039595?)|[12,531](https://www.3dmark.com/3dm/76039832?)|[25.20 GB/s](https://www.3dmark.com/3dm/76047162?)|
|4.0|x16|無効|[16,994](https://www.3dmark.com/3dm/76038517?)|[12,502](https://www.3dmark.com/3dm/76038699?)|[25.25 GB/s](https://www.3dmark.com/3dm/76041387?)|
|4.0| x8|有効|[17,101](https://www.3dmark.com/3dm/76042337?)|[12,517](https://www.3dmark.com/3dm/76042777?)|[14.24 GB/s](https://www.3dmark.com/3dm/76042903?)|
|4.0| x8|無効|[16,904](https://www.3dmark.com/3dm/76041823?)|[12,487](https://www.3dmark.com/3dm/76041998?)|[14.24 GB/s](https://www.3dmark.com/3dm/76042074?)|
|3.0|x16|有効|[17,093](https://www.3dmark.com/3dm/76040093?)|[12,498](https://www.3dmark.com/3dm/76040510?)|[14.22 GB/s](https://www.3dmark.com/3dm/76040567?)|
|3.0|x16|無効|[16,906](https://www.3dmark.com/3dm/76040785?)|[12,479](https://www.3dmark.com/3dm/76040929?)|[14.22 GB/s](https://www.3dmark.com/3dm/76040982?)|
|3.0| x8|有効|[17,054](https://www.3dmark.com/3dm/76043385?)|[12,512](https://www.3dmark.com/3dm/76043812?)| [7.13 GB/s](https://www.3dmark.com/3dm/76043918?)|
|3.0| x8|無効|[16,819](https://www.3dmark.com/3dm/76044264?)|[12,508](https://www.3dmark.com/3dm/76044590?)| [7.13 GB/s](https://www.3dmark.com/3dm/76044736?)|

### FF14

|PCIe Gen|レーン数|SAM|Score|Avg. FPS|Min. FPS|Load Time(sec)|
|---:|---:|:---:|---:|---:|---:|---:|
|4.0|x16|有効|23323|172.6171|62|9.640|
|4.0|x16|無効|23094|171.3106|59|9.505|
|4.0| x8|有効|23058|170.7601|60|9.885|
|4.0| x8|無効|22962|170.3157|58|9.596|
|3.0|x16|有効|23266|172.2443|61|9.717|
|3.0|x16|無効|23067|170.9268|58|9.572|
|3.0| x8|有効|23079|170.8510|61|9.753|
|3.0| x8|無効|22654|168.3763|59|9.309|

## 感想
変わっとるか・・・？

いやまあ、たしかに、たしかに、

スコアが4.0より3.0の方が低く、x16よりx8のほうが低いけど。。。誤差の範囲ちゃうか？

ということで、個人的な結論としては、3.0も4.0もほぼ変わらんということで。

5.0もあんまり体感できない感じかな。。。って思ってます。実ゲームではどうなるかは知らんけど。

PCIe機能テストと言う名の帯域測定テストだと思われるものは、レーン数やPCIeのバージョンに対してリニアに変わっていますね。

このことから、CPUとGPUで大量に通信を行う処理にはPCIeの通信帯域は重要になってくると思われます。

SAMは割りと目に見える感じで差がありますね。それでも1-2%ぐらいですが。

他にいい感じのベンチマークがあれば教えてほしいですが、8回ぐらい再起動して検証するのはそれはそれでめんどくさかったので、やらないかもしれません。